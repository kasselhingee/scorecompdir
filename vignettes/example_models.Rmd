---
title: "Plots of Example PPI Models"
author: "Kassel Hingee"
output:  pdf_document
vignette: >
  %\VignetteIndexEntry{Plots of Example PPI Models}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
bibliography: '`r system.file("REFERENCES.bib", package="scorecompdir")`'
---

This document ternary scatter plots for a number of example 3-component PPI models.

```{r setup, include=FALSE}
library(scorecompdir)
library(ggtern)
library(ggplot2)
library(dplyr)

knitr::opts_chunk$set(echo = TRUE)
n <- 1000
p <- 3
```

# Dirichlet
A Dirichlet model can be obtained by setting all of $A_L$ and $b_L$ to 0.

```{r dirichlet_simulate}
beta0=c(-0.8, -0.8, -0.5)

#simulate sample from PPI model
samp=rppi(n,beta = beta0, AL = 0, bL = 0,maxden = 4)
```

```{r dirichlet_plot}
data.frame(samp) %>%
  dplyr::rename(u1 = X1, u2 = X2, u3 = X3) %>%
  ggplot(aes(x = u1, y = u2, z = u3)) +
  coord_tern() +
  geom_density_tern(bins = 5, bdl = 0.01) + 
  geom_point(size = 1, alpha = 0.5, shape = "+")
```

# Model from Section 2.3 of Scealy and Wood (2022)
The model below is obtained by [@scealy2022sc]

```{r simulateS2_3model}
#dimension
p=3

#sample size
n=1000

#parameters for the PPI model
muL=matrix(0,p-1,1)
muL[1:sum(p,-1)]=0.12 #location is close to u1=0, u2=0.
aa=matrix(1/500,p-1,1)
D=diag(as.vector(aa))
SigA=D
SigA[1,1]=SigA[1,1]*2
cor=0.5
SigA[1,2]=cor*sqrt(SigA[1,1]*SigA[2,2])
SigA[2,1]=SigA[1,2]
ALs=-0.5*solve(SigA)
bL=solve(SigA)%*%muL
beta0=matrix(-0.8,p,1)
beta0[p]=-0.5

#simulate sample from PPI model
samp=rppi(n,beta = beta0, AL = ALs, bL = bL,maxden = 4)
```

```{r s2_3modelplot}
data.frame(samp) %>%
  dplyr::rename(u1 = X1, u2 = X2, u3 = X3) %>%
  ggplot(aes(x = u1, y = u2, z = u3)) +
  coord_tern() +
  geom_density_tern(bins = 5, bdl = 0.01) + 
  geom_point(size = 1, alpha = 0.5, shape = "+")
```

# Centre of Simplex
For a model with points focused on the interior of the simplex, change muL (influences bL) to close to 0.5, and make the beta exponents large.

```{r centresimplex_simulate}
#parameters for the PPI model
muL=matrix(0,p-1,1)
muL[1:sum(p,-1)]=0.3
aa=matrix(1/500,p-1,1)
D=diag(as.vector(aa))
SigA=D
SigA[1,1]=SigA[1,1]*2
cor=0.5
SigA[1,2]=cor*sqrt(SigA[1,1]*SigA[2,2])
SigA[2,1]=SigA[1,2]
ALs=-0.5*solve(SigA)
bL=solve(SigA)%*%muL
beta0=matrix(1,p,1)
samp=rppi(n,beta = beta0, AL = ALs, bL = bL,maxden = 30)
```

```{r centresimplex_plot}
colMeans(samp)
data.frame(samp) %>%
  dplyr::rename(u1 = X1, u2 = X2, u3 = X3) %>%
  ggplot(aes(x = u1, y = u2, z = u3)) +
  coord_tern() +
  geom_density_tern(bins = 5, bdl = 0.01) + 
  geom_point(size = 1, alpha = 0.5, shape = "+")
```

# Centre of Simplex with Near Zeros
An implausible model with points that are interior to the simplex and extra density near the simplex edges.
```{r centresimplex_wedge_simulate}
#parameters for the PPI model
muL=matrix(0,p-1,1)
muL[1:sum(p,-1)]=0.3
aa=matrix(1/500,p-1,1)
D=diag(as.vector(aa))
SigA=D
SigA[1,1]=SigA[1,1]*2
cor=0.5
SigA[1,2]=cor*sqrt(SigA[1,1]*SigA[2,2])
SigA[2,1]=SigA[1,2]
ALs=-0.5*solve(SigA)
bL=solve(SigA)%*%muL
beta0=matrix(-0.8,p,1)
samp=rppi(n,beta = beta0, AL = ALs, bL = bL,maxden = 30)
```

```{r centresimplex_w_edge_plot}
colMeans(samp)
data.frame(samp) %>%
  dplyr::rename(u1 = X1, u2 = X2, u3 = X3) %>%
  ggplot(aes(x = u1, y = u2, z = u3)) +
  coord_tern() +
  geom_density_tern(bins = 5, bdl = 0.01) + 
  geom_point(size = 1, alpha = 0.5, shape = "+")
```

# Large u1
```{r largeu1}
#parameters for the PPI model
muL=matrix(0,p-1,1)
muL[1, 1] <- 0.9
muL[2, 1] <- 0.12
aa=matrix(1/500,p-1,1)
D=diag(as.vector(aa))
SigA=D
SigA[1,1]=SigA[1,1]*2
cor=0.5
SigA[1,2]=cor*sqrt(SigA[1,1]*SigA[2,2])
SigA[2,1]=SigA[1,2]
ALs=-0.5*solve(SigA)
bL=solve(SigA)%*%muL
beta0=matrix(c(-0.5, -0.5, -0.5),p,1)

#simulate sample from PPI model
samp=rppi(n,beta = beta0, AL = ALs, bL = bL,maxden = 120)
```

```{r largeu1_plot}
data.frame(samp) %>%
  dplyr::rename(u1 = X1, u2 = X2, u3 = X3) %>%
  ggplot(aes(x = u1, y = u2, z = u3)) +
  coord_tern() +
  geom_density_tern(bins = 5, bdl = 0.01) + 
  geom_point(size = 1, alpha = 0.5, shape = "+")
```

# References

